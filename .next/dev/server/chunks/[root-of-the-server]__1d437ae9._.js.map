{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luisc/Documents/PROJETOS/crm-sistema/lib/firebase/admin.js"],"sourcesContent":["// lib/firebase/admin.js\nimport admin from 'firebase-admin'\n\n// Inicializar Firebase Admin apenas uma vez\nif (!admin.apps.length) {\n  try {\n    admin.initializeApp({\n      credential: admin.credential.cert({\n        projectId: process.env.FIREBASE_PROJECT_ID,\n        clientEmail: process.env.FIREBASE_CLIENT_EMAIL,\n        privateKey: process.env.FIREBASE_PRIVATE_KEY?.replace(/\\\\n/g, '\\n'),\n      }),\n      databaseURL: process.env.FIREBASE_DATABASE_URL,\n    })\n    console.log('✅ Firebase Admin inicializado')\n  } catch (error) {\n    console.error('❌ Erro ao inicializar Firebase Admin:', error)\n  }\n}\n\n// Exportar instâncias\nexport const db = admin.firestore()\nexport const auth = admin.auth()\nexport const storage = admin.storage()\n\n// Helper functions para Firestore\nexport const collections = {\n  users: () => db.collection('users'),\n  clientes: () => db.collection('clientes'),\n  leads: () => db.collection('leads'),\n  vendas: () => db.collection('vendas'),\n  atividades: () => db.collection('atividades'),\n}\n\n// Função para converter Timestamp do Firestore\nexport const convertTimestamp = (timestamp) => {\n  if (!timestamp) return null\n  return timestamp.toDate ? timestamp.toDate().toISOString() : timestamp\n}\n\n// Função para formatar documento do Firestore\nexport const formatDoc = (doc) => {\n  if (!doc.exists) return null\n  const data = doc.data()\n  return {\n    id: doc.id,\n    ...data,\n    criadoEm: convertTimestamp(data.criadoEm),\n    atualizadoEm: convertTimestamp(data.atualizadoEm),\n  }\n}\n\nexport default admin"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;;;;;;;;;;;;AACxB;;AAEA,4CAA4C;AAC5C,IAAI,CAAC,sIAAK,CAAC,IAAI,CAAC,MAAM,EAAE;IACtB,IAAI;QACF,sIAAK,CAAC,aAAa,CAAC;YAClB,YAAY,sIAAK,CAAC,UAAU,CAAC,IAAI,CAAC;gBAChC,WAAW,QAAQ,GAAG,CAAC,mBAAmB;gBAC1C,aAAa,QAAQ,GAAG,CAAC,qBAAqB;gBAC9C,YAAY,QAAQ,GAAG,CAAC,oBAAoB,EAAE,QAAQ,QAAQ;YAChE;YACA,aAAa,QAAQ,GAAG,CAAC,qBAAqB;QAChD;QACA,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yCAAyC;IACzD;AACF;AAGO,MAAM,KAAK,sIAAK,CAAC,SAAS;AAC1B,MAAM,OAAO,sIAAK,CAAC,IAAI;AACvB,MAAM,UAAU,sIAAK,CAAC,OAAO;AAG7B,MAAM,cAAc;IACzB,OAAO,IAAM,GAAG,UAAU,CAAC;IAC3B,UAAU,IAAM,GAAG,UAAU,CAAC;IAC9B,OAAO,IAAM,GAAG,UAAU,CAAC;IAC3B,QAAQ,IAAM,GAAG,UAAU,CAAC;IAC5B,YAAY,IAAM,GAAG,UAAU,CAAC;AAClC;AAGO,MAAM,mBAAmB,CAAC;IAC/B,IAAI,CAAC,WAAW,OAAO;IACvB,OAAO,UAAU,MAAM,GAAG,UAAU,MAAM,GAAG,WAAW,KAAK;AAC/D;AAGO,MAAM,YAAY,CAAC;IACxB,IAAI,CAAC,IAAI,MAAM,EAAE,OAAO;IACxB,MAAM,OAAO,IAAI,IAAI;IACrB,OAAO;QACL,IAAI,IAAI,EAAE;QACV,GAAG,IAAI;QACP,UAAU,iBAAiB,KAAK,QAAQ;QACxC,cAAc,iBAAiB,KAAK,YAAY;IAClD;AACF;uCAEe,sIAAK","debugId":null}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luisc/Documents/PROJETOS/crm-sistema/lib/utils/validation.js"],"sourcesContent":["// lib/utils/validation.js\nimport { z } from 'zod'\n\n// Schema de validação para Login\nexport const loginSchema = z.object({\n  email: z.string().email('Email inválido'),\n  password: z.string().min(6, 'Senha deve ter no mínimo 6 caracteres'),\n})\n\n// Schema de validação para Registro\nexport const registroSchema = z.object({\n  nome: z.string().min(3, 'Nome deve ter no mínimo 3 caracteres'),\n  email: z.string().email('Email inválido'),\n  password: z.string().min(6, 'Senha deve ter no mínimo 6 caracteres'),\n  empresa: z.string().min(2, 'Nome da empresa deve ter no mínimo 2 caracteres'),\n})\n\n// Schema de validação para Cliente\nexport const clienteSchema = z.object({\n  nome: z.string().min(3, 'Nome deve ter no mínimo 3 caracteres'),\n  email: z.string().email('Email inválido'),\n  telefone: z.string().optional(),\n  empresa: z.string().optional(),\n  cargo: z.string().optional(),\n  endereco: z.string().optional(),\n  cidade: z.string().optional(),\n  estado: z.string().optional(),\n  cep: z.string().optional(),\n})\n\n// Schema de validação para Lead\nexport const leadSchema = z.object({\n  nome: z.string().min(3, 'Nome deve ter no mínimo 3 caracteres'),\n  email: z.string().email('Email inválido'),\n  telefone: z.string().optional(),\n  empresa: z.string().optional(),\n  status: z.enum(['novo', 'contato', 'qualificado', 'perdido']).default('novo'),\n  fonte: z.string().optional(),\n  observacoes: z.string().optional(),\n})\n\n// Schema de validação para Venda\nexport const vendaSchema = z.object({\n  clienteId: z.string().min(1, 'Cliente é obrigatório'),\n  valor: z.number().positive('Valor deve ser positivo'),\n  descricao: z.string().min(3, 'Descrição deve ter no mínimo 3 caracteres'),\n  status: z.enum(['pendente', 'pago', 'cancelado']).default('pendente'),\n  dataVenda: z.string().optional(),\n})\n\n// Função helper para validar dados\nexport async function validateData(schema, data) {\n  try {\n    const validatedData = await schema.parseAsync(data)\n    return { success: true, data: validatedData }\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return {\n        success: false,\n        errors: error.errors.map(err => ({\n          field: err.path.join('.'),\n          message: err.message\n        }))\n      }\n    }\n    return {\n      success: false,\n      errors: [{ message: 'Erro na validação dos dados' }]\n    }\n  }\n}"],"names":[],"mappings":"AAAA,0BAA0B;;;;;;;;;;;;;;;AAC1B;;AAGO,MAAM,cAAc,yKAAC,CAAC,MAAM,CAAC;IAClC,OAAO,yKAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAC9B;AAGO,MAAM,iBAAiB,yKAAC,CAAC,MAAM,CAAC;IACrC,MAAM,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,yKAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,SAAS,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAC7B;AAGO,MAAM,gBAAgB,yKAAC,CAAC,MAAM,CAAC;IACpC,MAAM,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,yKAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,SAAS,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC5B,OAAO,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC1B,UAAU,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,QAAQ,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC3B,QAAQ,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC3B,KAAK,yKAAC,CAAC,MAAM,GAAG,QAAQ;AAC1B;AAGO,MAAM,aAAa,yKAAC,CAAC,MAAM,CAAC;IACjC,MAAM,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,yKAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,SAAS,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC5B,QAAQ,yKAAC,CAAC,IAAI,CAAC;QAAC;QAAQ;QAAW;QAAe;KAAU,EAAE,OAAO,CAAC;IACtE,OAAO,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC1B,aAAa,yKAAC,CAAC,MAAM,GAAG,QAAQ;AAClC;AAGO,MAAM,cAAc,yKAAC,CAAC,MAAM,CAAC;IAClC,WAAW,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC7B,OAAO,yKAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC3B,WAAW,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC7B,QAAQ,yKAAC,CAAC,IAAI,CAAC;QAAC;QAAY;QAAQ;KAAY,EAAE,OAAO,CAAC;IAC1D,WAAW,yKAAC,CAAC,MAAM,GAAG,QAAQ;AAChC;AAGO,eAAe,aAAa,MAAM,EAAE,IAAI;IAC7C,IAAI;QACF,MAAM,gBAAgB,MAAM,OAAO,UAAU,CAAC;QAC9C,OAAO;YAAE,SAAS;YAAM,MAAM;QAAc;IAC9C,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,yKAAC,CAAC,QAAQ,EAAE;YAC/B,OAAO;gBACL,SAAS;gBACT,QAAQ,MAAM,MAAM,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;wBAC/B,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC;wBACrB,SAAS,IAAI,OAAO;oBACtB,CAAC;YACH;QACF;QACA,OAAO;YACL,SAAS;YACT,QAAQ;gBAAC;oBAAE,SAAS;gBAA8B;aAAE;QACtD;IACF;AACF","debugId":null}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luisc/Documents/PROJETOS/crm-sistema/app/api/auth/registro/route.js"],"sourcesContent":["// app/api/auth/registro/route.js\nimport { NextResponse } from 'next/server'\nimport bcrypt from 'bcryptjs'\nimport { collections } from '@/lib/firebase/admin'\nimport { validateData, registroSchema } from '@/lib/utils/validation'\n\nexport async function POST(request) {\n  try {\n    const body = await request.json()\n\n    // Validar dados\n    const validation = await validateData(registroSchema, body)\n    if (!validation.success) {\n      return NextResponse.json(\n        { error: 'Dados inválidos', details: validation.errors },\n        { status: 400 }\n      )\n    }\n\n    const { nome, email, password, empresa } = validation.data\n\n    // Verificar se email já existe\n    const existingUser = await collections.users()\n      .where('email', '==', email)\n      .limit(1)\n      .get()\n\n    if (!existingUser.empty) {\n      return NextResponse.json(\n        { error: 'Email já cadastrado' },\n        { status: 409 }\n      )\n    }\n\n    // Hash da senha\n    const hashedPassword = await bcrypt.hash(password, 10)\n\n    // Criar usuário\n    const newUser = {\n      nome,\n      email,\n      password: hashedPassword,\n      empresa,\n      role: 'user',\n      status: 'ativo',\n      criadoEm: new Date().toISOString(),\n      atualizadoEm: new Date().toISOString()\n    }\n\n    const userRef = await collections.users().add(newUser)\n\n    // Retornar sucesso\n    return NextResponse.json({\n      success: true,\n      message: 'Usuário criado com sucesso',\n      userId: userRef.id\n    }, { status: 201 })\n\n  } catch (error) {\n    console.error('Erro no registro:', error)\n    return NextResponse.json(\n      { error: 'Erro ao criar usuário' },\n      { status: 500 }\n    )\n  }\n}"],"names":[],"mappings":"AAAA,iCAAiC;;;;;AACjC;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,gBAAgB;QAChB,MAAM,aAAa,MAAM,IAAA,4IAAY,EAAC,8IAAc,EAAE;QACtD,IAAI,CAAC,WAAW,OAAO,EAAE;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;gBAAmB,SAAS,WAAW,MAAM;YAAC,GACvD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,WAAW,IAAI;QAE1D,+BAA+B;QAC/B,MAAM,eAAe,MAAM,yIAAW,CAAC,KAAK,GACzC,KAAK,CAAC,SAAS,MAAM,OACrB,KAAK,CAAC,GACN,GAAG;QAEN,IAAI,CAAC,aAAa,KAAK,EAAE;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAElB;QAEA,gBAAgB;QAChB,MAAM,iBAAiB,MAAM,8IAAM,CAAC,IAAI,CAAC,UAAU;QAEnD,gBAAgB;QAChB,MAAM,UAAU;YACd;YACA;YACA,UAAU;YACV;YACA,MAAM;YACN,QAAQ;YACR,UAAU,IAAI,OAAO,WAAW;YAChC,cAAc,IAAI,OAAO,WAAW;QACtC;QAEA,MAAM,UAAU,MAAM,yIAAW,CAAC,KAAK,GAAG,GAAG,CAAC;QAE9C,mBAAmB;QACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT,QAAQ,QAAQ,EAAE;QACpB,GAAG;YAAE,QAAQ;QAAI;IAEnB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}