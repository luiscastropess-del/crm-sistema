"use strict";(()=>{var e={};e.id=9019,e.ids=[9019],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},40:(e,o,r)=>{r.r(o),r.d(o,{originalPathname:()=>O,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>p});var a={};r.r(a),r.d(a,{POST:()=>d});var t=r(9303),i=r(8716),s=r(670),n=r(7070),u=r(2023),c=r.n(u);async function d(e){try{let{nome:o,email:r,senha:a}=await e.json();if(!o||!r||!a)return n.NextResponse.json({erro:"Todos os campos s\xe3o obrigat\xf3rios"},{status:400});if(a.length<6)return n.NextResponse.json({erro:"A senha deve ter no m\xednimo 6 caracteres"},{status:400});let t=r.toLowerCase();if(!(await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("users").where("email","==",t).limit(1).get()).empty)return n.NextResponse.json({erro:"Este email j\xe1 est\xe1 cadastrado"},{status:409});let i=await c().hash(a,10),s=await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("users").add({nome:o,email:t,senha:i,avatar:"\uD83D\uDC64",telefone:"",empresa:"",cargo:"",configuracoes:{notificacoesEmail:!0,notificacoesPush:!0,notificacoesLeads:!0,notificacoesVendas:!0,notificacoesTarefas:!0,tema:"claro",idioma:"pt-BR",fusoHorario:"America/Sao_Paulo"},criadoEm:new Date,atualizadoEm:new Date,ultimoLogin:new Date}),u=Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())({uid:s.id,email:t,nome:o});return await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("atividades").add({userId:s.id,tipo:"registro",descricao:"Conta criada com sucesso",criadoEm:new Date}),await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("notificacoes").add({userId:s.id,titulo:"Bem-vindo ao CRM! \uD83C\uDF89",mensagem:"Sua conta foi criada com sucesso. Comece explorando o sistema!",tipo:"sucesso",lida:!1,criadoEm:new Date}),n.NextResponse.json({sucesso:!0,token:u,usuario:{uid:s.id,nome:o,email:t,avatar:"\uD83D\uDC64"}},{status:201})}catch(e){return console.error("Erro ao criar conta:",e),n.NextResponse.json({erro:"Erro ao processar registro"},{status:500})}}(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}();let l=new t.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/registro/route",pathname:"/api/auth/registro",filename:"route",bundlePath:"app/api/auth/registro/route"},resolvedPagePath:"C:\\Users\\luisc\\Documents\\PROJETOS\\crm-sistema\\app\\api\\auth\\registro\\route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:p,serverHooks:f}=l,O="/api/auth/registro/route";function h(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:p})}}};var o=require("../../../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),a=o.X(0,[9276,5972,2023],()=>r(40));module.exports=a})();