"use strict";(()=>{var e={};e.id=2673,e.ids=[2673],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2716:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>m,patchFetch:()=>O,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>p});var t={};o.r(t),o.d(t,{GET:()=>u,PUT:()=>c});var a=o(9303),n=o(8716),i=o(670),s=o(7070);async function u(e){try{let r=await Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(e);if(!r)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:401});let o=await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("users").doc(r.uid).get();if(!o.exists)return s.NextResponse.json({erro:"Usu\xe1rio n\xe3o encontrado"},{status:404});let t=o.data();return delete t.senha,s.NextResponse.json({sucesso:!0,perfil:{...t,uid:r.uid}})}catch(e){return console.error("Erro ao buscar perfil:",e),s.NextResponse.json({erro:"Erro ao buscar perfil"},{status:500})}}async function c(e){try{let r=await Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(e);if(!r)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:401});let o=await e.json(),t={nome:o.nome,telefone:o.telefone,empresa:o.empresa,cargo:o.cargo,avatar:o.avatar,configuracoes:o.configuracoes};return Object.keys(t).forEach(e=>{void 0===t[e]&&delete t[e]}),await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("users").doc(r.uid).update({...t,atualizadoEm:new Date}),await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("atividades").add({userId:r.uid,tipo:"perfil_atualizado",descricao:"Perfil atualizado com sucesso",criadoEm:new Date}),s.NextResponse.json({sucesso:!0,mensagem:"Perfil atualizado com sucesso"})}catch(e){return console.error("Erro ao atualizar perfil:",e),s.NextResponse.json({erro:"Erro ao atualizar perfil"},{status:500})}}(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}();let d=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/perfil/route",pathname:"/api/perfil",filename:"route",bundlePath:"app/api/perfil/route"},resolvedPagePath:"C:\\Users\\luisc\\Documents\\PROJETOS\\crm-sistema\\app\\api\\perfil\\route.js",nextConfigOutput:"",userland:t}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:f}=d,m="/api/perfil/route";function O(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:p})}}};var r=require("../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[9276,5972],()=>o(2716));module.exports=t})();