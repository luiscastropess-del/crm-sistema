"use strict";(()=>{var e={};e.id=7417,e.ids=[7417],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4239:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>p,patchFetch:()=>E,requestAsyncStorage:()=>f,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>O});var o={};a.r(o),a.d(o,{DELETE:()=>c,GET:()=>d,PUT:()=>u});var r=a(9303),n=a(8716),i=a(670),s=a(7070);async function d(e,{params:t}){try{let a=await Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(e);if(!a)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:401});let{id:o}=t,r=await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("tarefas").doc(o).get();if(!r.exists)return s.NextResponse.json({erro:"Tarefa n\xe3o encontrada"},{status:404});let n=r.data();if(n.userId!==a.uid)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:403});return s.NextResponse.json({sucesso:!0,tarefa:{id:r.id,...n,criadoEm:n.criadoEm?.toDate().toISOString(),dataVencimento:n.dataVencimento?.toDate().toISOString(),concluidoEm:n.concluidoEm?.toDate().toISOString()}})}catch(e){return console.error("Erro ao buscar tarefa:",e),s.NextResponse.json({erro:"Erro ao buscar tarefa"},{status:500})}}async function u(e,{params:t}){try{let a=await Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(e);if(!a)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:401});let{id:o}=t,r=await e.json(),n=await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("tarefas").doc(o).get();if(!n.exists)return s.NextResponse.json({erro:"Tarefa n\xe3o encontrada"},{status:404});if(n.data().userId!==a.uid)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:403});let i={...r,atualizadoEm:new Date};return"concluida"!==r.status||n.data().concluidoEm||(i.concluidoEm=new Date),"concluida"!==r.status&&n.data().concluidoEm&&(i.concluidoEm=null),await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("tarefas").doc(o).update(i),await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("atividades").add({userId:a.uid,tipo:"tarefa_atualizada",descricao:`Tarefa atualizada: ${r.titulo||n.data().titulo}`,entidadeId:o,entidadeTipo:"tarefa",criadoEm:new Date}),s.NextResponse.json({sucesso:!0,mensagem:"Tarefa atualizada com sucesso"})}catch(e){return console.error("Erro ao atualizar tarefa:",e),s.NextResponse.json({erro:"Erro ao atualizar tarefa"},{status:500})}}async function c(e,{params:t}){try{let a=await Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(e);if(!a)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:401});let{id:o}=t,r=await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("tarefas").doc(o).get();if(!r.exists)return s.NextResponse.json({erro:"Tarefa n\xe3o encontrada"},{status:404});if(r.data().userId!==a.uid)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:403});return await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("tarefas").doc(o).delete(),await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("atividades").add({userId:a.uid,tipo:"tarefa_excluida",descricao:`Tarefa exclu\xedda: ${r.data().titulo}`,criadoEm:new Date}),s.NextResponse.json({sucesso:!0,mensagem:"Tarefa exclu\xedda com sucesso"})}catch(e){return console.error("Erro ao excluir tarefa:",e),s.NextResponse.json({erro:"Erro ao excluir tarefa"},{status:500})}}(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}();let l=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/tarefas/id/route",pathname:"/api/tarefas/id",filename:"route",bundlePath:"app/api/tarefas/id/route"},resolvedPagePath:"C:\\Users\\luisc\\Documents\\PROJETOS\\crm-sistema\\app\\api\\tarefas\\id\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:O,serverHooks:m}=l,p="/api/tarefas/id/route";function E(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:O})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),o=t.X(0,[9276,5972],()=>a(4239));module.exports=o})();