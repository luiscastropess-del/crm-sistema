"use strict";(()=>{var e={};e.id=2254,e.ids=[2254],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7175:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>m,patchFetch:()=>O,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>f});var r={};a.r(r),a.d(r,{GET:()=>d,POST:()=>u});var o=a(9303),n=a(8716),i=a(670),s=a(7070);async function d(e){try{let t=await Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(e);if(!t)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:401});let{searchParams:a}=new URL(e.url),r=a.get("status"),o=a.get("prioridade"),n=Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("tarefas").where("userId","==",t.uid);r&&(n=n.where("status","==",r)),o&&(n=n.where("prioridade","==",o));let i=await n.orderBy("dataVencimento","asc").get(),d=[];return i.forEach(e=>{d.push({id:e.id,...e.data(),criadoEm:e.data().criadoEm?.toDate().toISOString(),dataVencimento:e.data().dataVencimento?.toDate().toISOString(),concluidoEm:e.data().concluidoEm?.toDate().toISOString()})}),s.NextResponse.json({sucesso:!0,total:d.length,tarefas:d})}catch(e){return console.error("Erro ao buscar tarefas:",e),s.NextResponse.json({erro:"Erro ao buscar tarefas"},{status:500})}}async function u(e){try{let t=await Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}())(e);if(!t)return s.NextResponse.json({erro:"N\xe3o autorizado"},{status:401});let{titulo:a,descricao:r,dataVencimento:o,prioridade:n="media",tipo:i="geral",clienteId:d,leadId:u}=await e.json();if(!a)return s.NextResponse.json({erro:"T\xedtulo \xe9 obrigat\xf3rio"},{status:400});let c=await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("tarefas").add({userId:t.uid,titulo:a,descricao:r||"",dataVencimento:o?new Date(o):null,prioridade:n,tipo:i,status:"pendente",clienteId:d||null,leadId:u||null,criadoEm:new Date,atualizadoEm:new Date,concluidoEm:null});return await Object(function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}()).collection("atividades").add({userId:t.uid,tipo:"tarefa_criada",descricao:`Nova tarefa criada: ${a}`,entidadeId:c.id,entidadeTipo:"tarefa",criadoEm:new Date}),s.NextResponse.json({sucesso:!0,id:c.id,mensagem:"Tarefa criada com sucesso"},{status:201})}catch(e){return console.error("Erro ao criar tarefa:",e),s.NextResponse.json({erro:"Erro ao criar tarefa"},{status:500})}}(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/lib/firebase-admin'");throw e.code="MODULE_NOT_FOUND",e}();let c=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/tarefas/route",pathname:"/api/tarefas",filename:"route",bundlePath:"app/api/tarefas/route"},resolvedPagePath:"C:\\Users\\luisc\\Documents\\PROJETOS\\crm-sistema\\app\\api\\tarefas\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:f,serverHooks:p}=c,m="/api/tarefas/route";function O(){return(0,i.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:f})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[9276,5972],()=>a(7175));module.exports=r})();